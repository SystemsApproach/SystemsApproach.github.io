
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>7.2 Multimedia Data Â· Computer Networks: A Systems Approach</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-block-align/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-smart-nav-collapse/smart-nav-collapse.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="summary.html" />
    
    
    <link rel="prev" href="presentation.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Preface
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../foundation/problem.html">
            
                <a href="../foundation/problem.html">
            
                    
                    Chapter 1: Foundation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../foundation/applications.html">
            
                <a href="../foundation/applications.html">
            
                    
                    1.1 Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../foundation/requirements.html">
            
                <a href="../foundation/requirements.html">
            
                    
                    1.2 Requirements
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../foundation/architecture.html">
            
                <a href="../foundation/architecture.html">
            
                    
                    1.3 Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../foundation/software.html">
            
                <a href="../foundation/software.html">
            
                    
                    1.4 Software
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../foundation/performance.html">
            
                <a href="../foundation/performance.html">
            
                    
                    1.5 Performance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../foundation/summary.html">
            
                <a href="../foundation/summary.html">
            
                    
                    1.6 Summary
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../direct/problem.html">
            
                <a href="../direct/problem.html">
            
                    
                    Chapter 2: Direct Connections
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../direct/perspective.html">
            
                <a href="../direct/perspective.html">
            
                    
                    2.1 Technology Landscape
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../direct/encoding.html">
            
                <a href="../direct/encoding.html">
            
                    
                    2.2 Encoding
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../direct/framing.html">
            
                <a href="../direct/framing.html">
            
                    
                    2.3 Framing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../direct/error.html">
            
                <a href="../direct/error.html">
            
                    
                    2.4 Error Detection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../direct/reliable.html">
            
                <a href="../direct/reliable.html">
            
                    
                    2.5 Reliable Transmission
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../direct/ethernet.html">
            
                <a href="../direct/ethernet.html">
            
                    
                    2.6 Multi-Access Networks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../direct/wireless.html">
            
                <a href="../direct/wireless.html">
            
                    
                    2.7 Wireless Networks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../direct/access.html">
            
                <a href="../direct/access.html">
            
                    
                    2.8 Access Networks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../direct/summary.html">
            
                <a href="../direct/summary.html">
            
                    
                    2.9 Summary
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../internetworking/problem.html">
            
                <a href="../internetworking/problem.html">
            
                    
                    Chapter 3: Internetworking
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../internetworking/switching.html">
            
                <a href="../internetworking/switching.html">
            
                    
                    3.1 Switching and Bridging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../internetworking/basic-ip.html">
            
                <a href="../internetworking/basic-ip.html">
            
                    
                    3.2 Basic Internetworking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../internetworking/routing.html">
            
                <a href="../internetworking/routing.html">
            
                    
                    3.3 Routing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../internetworking/impl.html">
            
                <a href="../internetworking/impl.html">
            
                    
                    3.4 Implementation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../internetworking/summary.html">
            
                <a href="../internetworking/summary.html">
            
                    
                    3.5 Summary
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../scaling/problem.html">
            
                <a href="../scaling/problem.html">
            
                    
                    Chapter 4: Advanced Internetworking
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../scaling/global.html">
            
                <a href="../scaling/global.html">
            
                    
                    4.1 Global Internet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../scaling/multicast.html">
            
                <a href="../scaling/multicast.html">
            
                    
                    4.2 Multicast
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../scaling/mpls.html">
            
                <a href="../scaling/mpls.html">
            
                    
                    4.3 Multiprotocol Label Switching
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../scaling/mobile-ip.html">
            
                <a href="../scaling/mobile-ip.html">
            
                    
                    4.4 Routing Among Mobile Devices
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../scaling/summary.html">
            
                <a href="../scaling/summary.html">
            
                    
                    4.5 Summary
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../e2e/problem.html">
            
                <a href="../e2e/problem.html">
            
                    
                    Chapter 5: End-to-End Protocols
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../e2e/udp.html">
            
                <a href="../e2e/udp.html">
            
                    
                    5.1 Simple Demultiplexor (UDP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../e2e/tcp.html">
            
                <a href="../e2e/tcp.html">
            
                    
                    5.2 Reliable Byte Stream (TCP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../e2e/rpc.html">
            
                <a href="../e2e/rpc.html">
            
                    
                    5.3 Remote Procedure Call
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../e2e/rtp.html">
            
                <a href="../e2e/rtp.html">
            
                    
                    5.4 Transport for Real-Time (RTP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../e2e/summary.html">
            
                <a href="../e2e/summary.html">
            
                    
                    5.5 Summary
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../congestion/problem.html">
            
                <a href="../congestion/problem.html">
            
                    
                    Chapter 6: Congestion Control
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../congestion/issues.html">
            
                <a href="../congestion/issues.html">
            
                    
                    6.1 Issues in Resource Allocation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../congestion/queuing.html">
            
                <a href="../congestion/queuing.html">
            
                    
                    6.2 Queuing Disciplines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../congestion/tcpcc.html">
            
                <a href="../congestion/tcpcc.html">
            
                    
                    6.3 TCP Congestion Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../congestion/avoidance.html">
            
                <a href="../congestion/avoidance.html">
            
                    
                    6.4 Advanced Congestion Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../congestion/qos.html">
            
                <a href="../congestion/qos.html">
            
                    
                    6.5 Quality of Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="../congestion/summary.html">
            
                <a href="../congestion/summary.html">
            
                    
                    6.6 Summary
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="problem.html">
            
                <a href="problem.html">
            
                    
                    Chapter 7: End-to-End Data
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="presentation.html">
            
                <a href="presentation.html">
            
                    
                    7.1 Presentation Formatting
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.8.2" data-path="multimedia.html">
            
                <a href="multimedia.html">
            
                    
                    7.2 Multimedia Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="summary.html">
            
                <a href="summary.html">
            
                    
                    7.3 Summary
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../security/problem.html">
            
                <a href="../security/problem.html">
            
                    
                    Chapter 8: Network Security
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../security/trust.html">
            
                <a href="../security/trust.html">
            
                    
                    8.1 Trust and Threats
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../security/crypto.html">
            
                <a href="../security/crypto.html">
            
                    
                    8.2 Cryptographic Building Blocks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../security/key-distro.html">
            
                <a href="../security/key-distro.html">
            
                    
                    8.3 Key Predistribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../security/authentication.html">
            
                <a href="../security/authentication.html">
            
                    
                    8.4 Authentication Protocols
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="../security/systems.html">
            
                <a href="../security/systems.html">
            
                    
                    8.5 Example Systems
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="../security/summary.html">
            
                <a href="../security/summary.html">
            
                    
                    8.6 Summary
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../applications/problem.html">
            
                <a href="../applications/problem.html">
            
                    
                    Chapter 9: Applications
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../applications/traditional.html">
            
                <a href="../applications/traditional.html">
            
                    
                    9.1 Traditional Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../applications/multimedia.html">
            
                <a href="../applications/multimedia.html">
            
                    
                    9.2 Multimedia Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../applications/infrastructure.html">
            
                <a href="../applications/infrastructure.html">
            
                    
                    9.3 Infrastructure Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="../applications/overlays.html">
            
                <a href="../applications/overlays.html">
            
                    
                    9.4 Overlay Networks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="../applications/summary.html">
            
                <a href="../applications/summary.html">
            
                    
                    9.5 Summary
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >7.2 Multimedia Data</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="72-multimedia-data">7.2 Multimedia Data</h1>
<p>Multimedia data, comprised of audio, video, and still images, now makes
up the majority of traffic on the Internet. Part of what has made the
widespread transmission of multimedia across networks possible is
advances in compression technology. Because multimedia data is
consumed mostly by humans using their senses&#x2014;vision and hearing&#x2014;and
processed by the human brain, there are unique challenges to
compressing it. You want to try to keep the information that is most
important to a human, while getting rid of anything that doesn&apos;t
improve the human&apos;s perception of the visual or auditory experience.
Hence, both computer science and the study of human perception come
into play. In this section, we&apos;ll look at some of the major efforts in
representing and compressing multimedia data.</p>
<p>The uses of compression are not limited to multimedia data of
course&#x2014;for example, you may well have used a utility like <code>zip</code> or
<code>compress</code> to compress files before sending them over a network, or to
uncompress a data file after downloading. It turns out that the
techniques used for compressing data&#x2014;which are typically <em>lossless</em>,
because most people don&apos;t like to lose data from a file&#x2014;also show up
as part of the solution for multimedia compression. In contrast, <em>lossy
compression</em>, commonly used for multimedia data, does not promise that
the data received is exactly the same as the data sent. As noted above,
this is because multimedia data often contains information that is of
little utility to the human who receives it. Our senses and brains can
only perceive so much detail. They are also very good at filling in
missing pieces and even correcting some errors in what we see or hear.
And, lossy algorithms typically achieve much better compression ratios
than do their lossless counterparts; they can be an order of magnitude
better or more.</p>
<p>To get a sense of how important compression has been to the spread of
networked multimedia, consider the following example. A high-definition
TV screen has something like 1080 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> 1920 pixels, each of which
has 24 bits of color information, so each frame is</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn><mn>8</mn><mn>0</mn><mo>&#xD7;</mo><mn>1</mn><mn>9</mn><mn>2</mn><mn>0</mn><mo>&#xD7;</mo><mn>2</mn><mn>4</mn><mo>=</mo><mn>5</mn><mn>0</mn><mtext>&#xA0;</mtext><mi>M</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">
1080 \times 1920 \times 24 = 50\ Mb
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">8</span><span class="mord mathrm">0</span><span class="mbin">&#xD7;</span><span class="mord mathrm">1</span><span class="mord mathrm">9</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mbin">&#xD7;</span><span class="mord mathrm">2</span><span class="mord mathrm">4</span><span class="mrel">=</span><span class="mord mathrm">5</span><span class="mord mathrm">0</span><span class="mord mathit"><span class="mspace">&#xA0;</span><span class="mord mathit" style="margin-right:0.10903em;">M</span></span><span class="mord mathit">b</span></span></span></span></span></p>
<p>so if you want to send 24 frames per second, that would be over 1 Gbps.
That&apos;s a lot more than most Internet users have access to, by a good
margin. By contrast, modern compression techniques can get a reasonably
high-quality HDTV signal down to the range of 10 Mbps, a two order of
magnitude reduction and well within the reach of many broadband users.
Similar compression gains apply to lower quality video such as YouTube
clips&#x2014;Web video could never have reached its current popularity
without compression to make all those entertaining videos fit within the
bandwidth of today&apos;s networks.</p>
<p>Compression techniques as applied to multimedia have been an area of
great innovation in recent years, particularly lossy compression.
Lossless techniques also have an important role to play, however.
Indeed, most of the lossy techniques include some steps that are
lossless, so we begin our discussion with an overview of lossless
compression.</p>
<h2 id="lossless-compression-techniques">Lossless Compression Techniques</h2>
<p>In many ways, compression is inseparable from data encoding. When
thinking about how to encode a piece of data in a set of bits, we might
just as well think about how to encode the data in the smallest set of
bits possible. For example, if you have a block of data that is made up
of the 26 symbols A through Z, and if all of these symbols have an
equal chance of occurring in the data block you are encoding, then
encoding each symbol in 5 bits is the best you can do (since 2<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow></mrow><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">5</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> = 32
is the lowest power of 2 above 26). If, however, the symbol R occurs
50% of the time, then it would be a good idea to use fewer bits to
encode the R than any of the other symbols. In general, if you know
the relative probability that each symbol will occur in the data, then
you can assign a different number of bits to each possible symbol in a
way that minimizes the number of bits it takes to encode a given block
of data. This is the essential idea of <em>Huffman codes</em>, one of the
important early developments in data compression.</p>
<h3 id="run-length-encoding">Run Length Encoding</h3>
<p>Run length encoding (RLE) is a compression technique with a brute-force
simplicity. The idea is to replace consecutive occurrences of a given
symbol with only one copy of the symbol, plus a count of how many times
that symbol occurs&#x2014;hence, the name <em>run length</em>. For example, the
string <code>AAABBCDDDD</code> would be encoded as <code>3A2B1C4D</code>.</p>
<p>RLE turns out to be useful for compressing some classes of images. It
can be used in this context by comparing adjacent pixel values and then
encoding only the changes. For images that have large homogeneous
regions, this technique is quite effective. For example, it is not
uncommon that RLE can achieve compression ratios on the order of 8-to-1
for scanned text images. RLE works well on such files because they often
contain a large amount of white space that can be removed. For those
old enough to remember the technology, RLE was the key compression
algorithm used to transmit faxes. However, for
images with even a small degree of local variation, it is not uncommon
for compression to actually increase the image byte size, since it takes
2 bytes to represent a single symbol when that symbol is not repeated.</p>
<h3 id="differential-pulse-code-modulation">Differential Pulse Code Modulation</h3>
<p>Another simple lossless compression algorithm is Differential Pulse Code
Modulation (DPCM). The idea here is to first output a reference symbol
and then, for each symbol in the data, to output the difference between
that symbol and the reference symbol. For example, using symbol
A as the reference symbol, the string <code>AAABBCDDDD</code> would be encoded as
<code>A0001123333</code> because A is the same as the reference symbol, B has a
difference of 1 from the reference symbol, and so on. Note that this
simple example does not illustrate the real benefit of DPCM, which is
that when the differences are small they can be encoded with fewer
bits than the symbol itself. In this example, the range of
differences, 0-3, can be represented with 2 bits each, rather than the
7 or 8 bits required by the full character. As soon as the difference
becomes too large, a new reference symbol is selected.</p>
<p>DPCM works better than RLE for most digital imagery, since it takes
advantage of the fact that adjacent pixels are usually similar. Due to
this correlation, the dynamic range of the differences between the
adjacent pixel values can be significantly less than the dynamic range
of the original image, and this range can therefore be represented using
fewer bits. Using DPCM, we have measured compression ratios of 1.5-to-1
on digital images. DPCM also works on audio, because adjacent samples of
an audio waveform are likely to be close in value.</p>
<p>A slightly different approach, called <em>delta encoding</em>, simply encodes a
symbol as the difference from the previous one. Thus, for example,
<code>AAABBCDDDD</code> would be represented as <code>A001011000</code>. Note that delta
encoding is likely to work well for encoding images where adjacent
pixels are similar. It is also possible to perform RLE after delta
encoding, since we might find long strings of 0s if there are many
similar symbols next to each other.</p>
<h3 id="dictionary-based-methods">Dictionary-Based Methods</h3>
<p>The final lossless compression method we consider is the
dictionary-based approach, of which the Lempel-Ziv (LZ) compression
algorithm is the best known. The Unix <code>compress</code> and <code>gzip</code> commands
use variants of the LZ algorithm.</p>
<p>The idea of a dictionary-based compression algorithm is to build a
dictionary (table) of variable-length strings (think of them as common
phrases) that you expect to find in the data and then to replace each of
these strings when it appears in the data with the corresponding index
to the dictionary. For example, instead of working with individual
characters in text data, you could treat each word as a string and
output the index in the dictionary for that word. To further elaborate
on this example, the word <em>compression</em> has the index 4978 in one
particular dictionary; it is the 4978th word in . To compress a body of
text, each time the string &quot;compression&quot; appears, it would be replaced
by 4978. Since this particular dictionary has just over 25,000 words in
it, it would take 15 bits to encode the index, meaning that the string
&quot;compression&quot; could be represented in 15 bits rather than the 77 bits
required by 7-bit ASCII. This is a compression ratio of 5-to-1! At
another data point, we were able to get a 2-to-1 compression ratio when
we applied the <code>compress</code> command to the source code for the protocols
described in this book.</p>
<p>Of course, this leaves the question of where the dictionary comes from.
One option is to define a static dictionary, preferably one that is
tailored for the data being compressed. A more general solution, and the
one used by LZ compression, is to adaptively define the dictionary based
on the contents of the data being compressed. In this case, however, the
dictionary constructed during compression has to be sent along with the
data so that the decompression half of the algorithm can do its job.
Exactly how you build an adaptive dictionary has been a subject of
extensive research.</p>
<h2 id="image-representation-and-compression-gif-jpeg">Image Representation and Compression (GIF, JPEG)</h2>
<p>Given the ubiquitous use of digital imagery&#x2014;this
use was spawned by the invention of graphical displays, not high-speed
networks&#x2014;the need for standard representation formats and compression
algorithms for digital imagery data has become essential. In
response to this need, the ISO defined a digital image format known as
<em>JPEG</em>, named after the Joint Photographic Experts Group that designed
it. (The &quot;Joint&quot; in JPEG stands for a joint ISO/ITU effort.) JPEG is the
most widely used format for still images in use today. At the heart of
the definition of the format is a compression algorithm, which we
describe below. Many techniques used in JPEG also appear in MPEG, the
set of standards for video compression and transmission created by the
Moving Picture Experts Group.</p>
<p>Before delving into the details of JPEG, we observe that there are quite
a few steps to get from a digital image to a compressed representation
of that image that can be transmitted, decompressed, and displayed
correctly by a receiver. You probably know that digital images are made
up of pixels (hence, the megapixels quoted in smartphone camera
advertisements). Each pixel represents one location in the
two-dimensional grid that makes up the image, and for color images each
pixel has some numerical value representing a color. There are lots of
ways to represent colors, referred to as <em>color spaces</em>; the one most
people are familiar with is RGB (red, green, blue). You can think of
color as being a three dimensional quantity&#x2014;you can make any color out
of red, green, and blue light in different amounts. In a
three-dimensional space, there are lots of different, valid ways to
describe a given point (consider Cartesian and polar coordinates, for
example). Similarly, there are various ways to describe a color using
three quantities, and the most common alternative to RGB is YUV. The Y
is luminance, roughly the overall brightness of the pixel, and U and V
contain chrominance, or color information. Confoundingly, there are a
few different variants of the YUV color space as well. More on this in a
moment.</p>
<p>The significance of this discussion is that the encoding and
transmission of color images (either still or moving) requires agreement
between the two ends on the color space. Otherwise, of course, you&apos;d end
up with different colors being displayed by the receiver than were
captured by the sender. Hence, agreeing on a color space definition (and
perhaps a way to communicate which particular space is in use) is part
of the definition of any image or video format.</p>
<p>Let&apos;s look at the example of the Graphical Interchange Format (GIF). GIF
uses the RGB color space and starts out with 8 bits to represent each of
the three dimensions of color for a total of 24 bits. Rather than
sending those 24 bits per pixel, however, GIF first reduces 24-bit color
images to 8-bit color images. This is done by identifying the colors
used in the picture, of which there will typically be considerably fewer
than 2<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow></mrow><mrow><mn>2</mn><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">^{24}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span><span class="mord mathrm mtight">4</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, and then picking the 256 colors that most closely
approximate the colors used in the picture. There might be more than 256
colors, however, so the trick is to try not to distort the color too
much by picking 256 colors such that no pixel has its color changed too
much.</p>
<p>The 256 colors are stored in a table, which can be indexed with an 8-bit
number, and the value for each pixel is replaced by the appropriate
index. Note that this is an example of lossy compression for any picture
with more than 256 colors. GIF then runs an LZ variant over the result,
treating common sequences of pixels as the strings that make up the
dictionary&#x2014;a lossless operation. Using this approach, GIF is sometimes
able to achieve compression ratios on the order of 10:1, but only when
the image consists of a relatively small number of discrete colors.
Graphical logos, for example, are handled well by GIF. Images of natural
scenes, which often include a more continuous spectrum of colors, cannot
be compressed at this ratio using GIF. It is also not too hard for a
human eye to detect the distortion caused by the lossy color reduction
of GIF in some cases.</p>
<p>The JPEG format is considerably more well suited to photographic images,
as you would hope given the name of the group that created it. JPEG does
not reduce the number of colors like GIF. Instead, JPEG starts off by
transforming the RGB colors (which are what you usually get out of a
digital camera) to the YUV space. The reason for this has to do with the
way the eye perceives images. There are receptors in the eye for
brightness, and separate receptors for color. Because we&apos;re very good at
perceiving variations in brightness, it makes sense to spend more bits
on transmitting brightness information. Since the Y component of YUV is,
roughly, the brightness of the pixel, we can compress that component
separately, and less aggressively, from the other two (chrominance)
components.</p>
<p>As noted above, YUV and RGB are alternative ways to describe a point in
a 3-dimensional space, and it&apos;s possible to convert from one color space
to another using linear equations. For one YUV space that is commonly
used to represent digital images, the equations are:</p>
<pre><code class="lang-pseudo">Y = 0.299R + 0.587G + 0.114B
U = (B-Y) x 0.565
V =  (R-Y) x 0.713
</code></pre>
<p>The exact values of the
constants here are not important, as long as the encoder and decoder
agree on what they are. (The decoder will have to apply the inverse
transformations to recover the RGB components needed to drive a
display.) The constants are, however, carefully chosen based on the
human perception of color. You can see that Y, the luminance, is a sum
of the red, green, and blue components, while U and V are color
difference components. U represents the difference between the luminance
and blue, and V the difference between luminance and red. You may notice
that setting R, G, and B to their maximum values (which would be 255 for
8-bit representations) will also produce a value of Y=255 while U and
V in this case would be zero. That is, a fully white pixel is
(255,255,255) in RGB space and (255,0,0) in YUV space.</p>
<figure class="line">
    <a id="yuvsub"></a>
    <img src="figures/f07-11-9780123850591.png" width="500px">
    <figcaption>Subsampling the U and V components of an
    image.</figcaption>
</figure>

<p>Once the image has been transformed into YUV space, we can now think
about compressing each of the three components separately. We want to be
more aggressive in compressing the U and V components, to which human
eyes are less sensitive. One way to compress the U and V components is
to <em>subsample</em> them. The basic idea of subsampling is to take a number
of adjacent pixels, calculate the average U or V value for that group of
pixels, and transmit that, rather than sending the value for every
pixel. <a href="#yuvsub">Figure 1</a> illustrates the point. The luminance (Y)
component is not subsampled, so the Y value of all the pixels will be
transmitted, as indicated by the 16 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> 16 grid of pixels on the
left. In the case of U and V, we treat each group of four adjacent
pixels as a group, calculate the average of the U or V value for that
group, and transmit that. Hence, we end up with an 8 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> 8 grid of
U and V values to transmit. Thus, in this example, for every four
pixels, we transmit six values (four Y and one each of U and V) rather
than the original 12 values (four each for all three components), for a
50% reduction in information.</p>
<p>It&apos;s worth noting that you could be either more or less aggressive in
the subsampling, with corresponding increases in compression and
decreases in quality. The subsampling approach shown here, in which
chrominance is subsampled by a factor of two in both horizontal and
vertical directions (and which goes by the identification 4:2:0),
happens to match the most common approach used for both JPEG and MPEG.</p>
<figure class="line">
    <a id="jpeg"></a>
    <img src="figures/f07-12-9780123850591.png" width="550px">
    <figcaption>Block diagram of JPEG compression.</figcaption>
</figure>

<p>Once subsampling is done, we now have three grids of pixels to deal
with, and each one is dealt with separately. JPEG compression of each
component takes place in three phases, as illustrated in
<a href="#jpeg">Figure 2</a>. On the compression side, the image is fed through
these three phases one 8 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> 8 block at a time. The first phase
applies the discrete cosine transform (DCT) to the block. If you think
of the image as a signal in the spatial domain, then DCT transforms this
signal into an equivalent signal in the <em>spatial frequency</em> domain. This
is a lossless operation but a necessary precursor to the next, lossy
step. After the DCT, the second phase applies a quantization to the
resulting signal and, in so doing, loses the least significant
information contained in that signal. The third phase encodes the final
result, but in so doing also adds an element of lossless compression to
the lossy compression achieved by the first two phases. Decompression
follows these same three phases, but in reverse order.</p>
<h3 id="dct-phase">DCT Phase</h3>
<p>DCT is a transformation closely related to the fast Fourier transform
(FFT). It takes an 8 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> 8 matrix of pixel values as input and
outputs an 8 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> 8 matrix of frequency coefficients. You can think of
the input matrix as a 64-point signal that is defined in two spatial
dimensions (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span>); DCT breaks this signal into 64 spatial
frequencies. To get an intuitive feel for spatial frequency, imagine
yourself moving across a picture in, say, the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span> direction. You would
see the value of each pixel varying as some function of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>. If this
value changes slowly with increasing <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>, then it has a low spatial
frequency; if it changes rapidly, it has a high spatial frequency. So
the low frequencies correspond to the gross features of the picture,
while the high frequencies correspond to fine detail. The idea behind
the DCT is to separate the gross features, which are essential to
viewing the image, from the fine detail, which is less essential and, in
some cases, might be barely perceived by the eye.</p>
<p>DCT, along with its inverse, which recovers the original pixels and
during decompression, are defined by the following formulas:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow><mi>D</mi><mi>C</mi><mi>T</mi><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo></mrow></mtd><mtd><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><msqrt><mrow><mn>2</mn><mi>N</mi></mrow></msqrt></mrow></mfrac><mi>C</mi><mo>(</mo><mi>i</mi><mo>)</mo><mi>C</mi><mo>(</mo><mi>j</mi><mo>)</mo><msubsup><mo>&#x2211;</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><msubsup><mo>&#x2211;</mo><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><mi>p</mi><mi>i</mi><mi>x</mi><mi>e</mi><mi>l</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo><mi>cos</mi><mrow><mo fence="true">[</mo><mfrac><mrow><mo>(</mo><mn>2</mn><mi>x</mi><mo>+</mo><mn>1</mn><mo>)</mo><mi>i</mi><mi>&#x3C0;</mi></mrow><mrow><mn>2</mn><mi>N</mi></mrow></mfrac><mo fence="true">]</mo></mrow><mi>cos</mi><mrow><mo fence="true">[</mo><mfrac><mrow><mo>(</mo><mn>2</mn><mi>y</mi><mo>+</mo><mn>1</mn><mo>)</mo><mi>j</mi><mi>&#x3C0;</mi></mrow><mrow><mn>2</mn><mi>N</mi></mrow></mfrac><mo fence="true">]</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mi mathvariant="italic">p</mi><mi mathvariant="italic">i</mi><mi mathvariant="italic">x</mi><mi mathvariant="italic">e</mi><mi mathvariant="italic">l</mi></mrow><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo></mrow></mtd><mtd><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><msqrt><mrow><mn>2</mn><mi>N</mi></mrow></msqrt></mrow></mfrac><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><msubsup><mo>&#x2211;</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><mi>C</mi><mo>(</mo><mi>i</mi><mo>)</mo><mi>C</mi><mo>(</mo><mi>j</mi><mo>)</mo><mi>D</mi><mi>C</mi><mi>T</mi><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo><mi>cos</mi><mrow><mo fence="true">[</mo><mfrac><mrow><mo>(</mo><mn>2</mn><mi>x</mi><mo>+</mo><mn>1</mn><mo>)</mo><mi>i</mi><mi>&#x3C0;</mi></mrow><mrow><mn>2</mn><mi>N</mi></mrow></mfrac><mo fence="true">]</mo></mrow><mi>cos</mi><mrow><mo fence="true">[</mo><mfrac><mrow><mo>(</mo><mn>2</mn><mi>y</mi><mo>+</mo><mn>1</mn><mo>)</mo><mi>j</mi><mi>&#x3C0;</mi></mrow><mrow><mn>2</mn><mi>N</mi></mrow></mfrac><mo fence="true">]</mo></mrow></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\begin{aligned}
DCT(i,j) &amp;=&amp;  \frac{1}{\sqrt{2N}} C(i) C(j) \sum_{x=0}^{N-1}
 \sum_{y=0}^{N-1} pixel(x, y) 
 \cos \left[ \frac{(2x+1)i \pi}{2N}\right]
 \cos \left[ \frac{(2y+1)j \pi}{2N}\right]\\
\mathit{pixel}(x,y) &amp;=&amp;  \frac{1}{\sqrt{2N}} \sum_{i=0}^{N-1}
 \sum_{j=0}^{N-1} C(i) C(j) DCT(i, j) 
 \cos \left[ \frac{(2x+1)i \pi}{2N}\right]
 \cos \left[ \frac{(2y+1)j \pi}{2N}\right]
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:3.486835em;"></span><span class="strut bottom" style="height:6.47367em;vertical-align:-2.986835em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.6584989999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span><span style="top:1.5730580000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">p</span><span class="mord mathit">i</span><span class="mord mathit">x</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.6584989999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span></span></span><span style="top:1.5730580000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:2em;"></span><span class="col-align-r"><span class="vlist"><span style="top:-1.6584989999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.8166650000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord sqrt"><span class="sqrt-sign" style="top:-0.08666499999999999em;"><span class="style-wrap reset-textstyle textstyle uncramped">&#x221A;</span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span style="top:-0.846665em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1671129999999998em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">0</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.167113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">0</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-1.250005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord mathit">p</span><span class="mord mathit">i</span><span class="mord mathit">x</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mop">cos</span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">2</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mop">cos</span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span><span style="top:1.5730580000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.8166650000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord sqrt"><span class="sqrt-sign" style="top:-0.08666499999999999em;"><span class="style-wrap reset-textstyle textstyle uncramped">&#x221A;</span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span style="top:-0.846665em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">0</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">0</span></span></span></span><span style="top:-0.000005000000000254801em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-1.2500050000000005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mop">cos</span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">2</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mop">cos</span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><msqrt><mrow><mn>2</mn></mrow></msqrt></mrow><annotation encoding="application/x-tex">C(x) = 1/\sqrt{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9072200000000001em;"></span><span class="strut bottom" style="height:1.1572200000000001em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">/</span><span class="mord sqrt"><span class="sqrt-sign" style="top:-0.06722000000000006em;"><span class="style-wrap reset-textstyle textstyle uncramped">&#x221A;</span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span><span style="top:-0.8272200000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span> when <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span> when
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span><span class="mrel">&gt;</span><span class="mord mathrm">0</span></span></span></span>, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>i</mi><mi>x</mi><mi>e</mi><mi>l</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">pixel(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mord mathit">i</span><span class="mord mathit">x</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> is the grayscale value of the
pixel at position <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> in the 8 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> 8 block being
compressed; N = 8 in this case.</p>
<p>The first frequency coefficient, at location (0,0) in the output matrix,
is called the <em>DC coefficient</em>. Intuitively, we can see that the DC
coefficient is a measure of the average value of the 64 input pixels.
The other 63 elements of the output matrix are called the <em>AC
coefficients</em>. They add the higher-spatial-frequency information to this
average value. Thus, as you go from the first frequency coefficient
toward the 64th frequency coefficient, you are moving from low-frequency
information to high-frequency information, from the broad strokes of the
image to finer and finer detail. These higher-frequency coefficients are
increasingly unimportant to the perceived quality of the image. It is
the second phase of JPEG that decides which portion of which
coefficients to throw away.</p>
<h3 id="quantization-phase">Quantization Phase</h3>
<p>The second phase of JPEG is where the compression becomes lossy. DCT
does not itself lose information; it just transforms the image into a
form that makes it easier to know what information to remove. (Although
not lossy, <em>per se</em>, there is of course some loss of precision during
the DCT phase because of the use of fixed-point arithmetic.)
Quantization is easy to understand&#x2014;it&apos;s simply a matter of dropping
the insignificant bits of the frequency coefficients.</p>
<p>To see how the quantization phase works, imagine that you want to
compress some whole numbers less than 100, such as 45, 98, 23, 66,
and 7. If you decided that knowing these numbers truncated to the nearest
multiple of 10 is sufficient for your purposes, then you could divide
each number by the quantum 10 using integer arithmetic,
yielding 4, 9, 2, 6, and 0. These numbers can each be encoded in
4 bits rather than the 7 bits needed to encode the original numbers.</p>
<p><a id="quant"></a></p>
<table>
<thead>
<tr>
<th style="text-align:right">Quantum</th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
<th style="text-align:right"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">5</td>
<td style="text-align:right">7</td>
<td style="text-align:right">9</td>
<td style="text-align:right">11</td>
<td style="text-align:right">13</td>
<td style="text-align:right">15</td>
<td style="text-align:right">17</td>
</tr>
<tr>
<td style="text-align:right">5</td>
<td style="text-align:right">7</td>
<td style="text-align:right">9</td>
<td style="text-align:right">11</td>
<td style="text-align:right">13</td>
<td style="text-align:right">15</td>
<td style="text-align:right">17</td>
<td style="text-align:right">19 </td>
</tr>
<tr>
<td style="text-align:right">7</td>
<td style="text-align:right">9</td>
<td style="text-align:right">11</td>
<td style="text-align:right">13</td>
<td style="text-align:right">15</td>
<td style="text-align:right">17</td>
<td style="text-align:right">19</td>
<td style="text-align:right">21</td>
</tr>
<tr>
<td style="text-align:right">9</td>
<td style="text-align:right">11</td>
<td style="text-align:right">13</td>
<td style="text-align:right">15</td>
<td style="text-align:right">17</td>
<td style="text-align:right">19</td>
<td style="text-align:right">21</td>
<td style="text-align:right">23</td>
</tr>
<tr>
<td style="text-align:right">11</td>
<td style="text-align:right">13</td>
<td style="text-align:right">15</td>
<td style="text-align:right">17</td>
<td style="text-align:right">19</td>
<td style="text-align:right">21</td>
<td style="text-align:right">23</td>
<td style="text-align:right">25</td>
</tr>
<tr>
<td style="text-align:right">13</td>
<td style="text-align:right">15</td>
<td style="text-align:right">17</td>
<td style="text-align:right">19</td>
<td style="text-align:right">21</td>
<td style="text-align:right">23</td>
<td style="text-align:right">25</td>
<td style="text-align:right">27</td>
</tr>
<tr>
<td style="text-align:right">15</td>
<td style="text-align:right">17</td>
<td style="text-align:right">19</td>
<td style="text-align:right">21</td>
<td style="text-align:right">23</td>
<td style="text-align:right">25</td>
<td style="text-align:right">27</td>
<td style="text-align:right">29</td>
</tr>
<tr>
<td style="text-align:right">17</td>
<td style="text-align:right">19</td>
<td style="text-align:right">21</td>
<td style="text-align:right">23</td>
<td style="text-align:right">25</td>
<td style="text-align:right">27</td>
<td style="text-align:right">29</td>
<td style="text-align:right">31</td>
</tr>
</tbody>
</table>
<div class="ba-center"><p><em>Table 1. Example JPEG Quantization Table.</em></p></div>

<p>Rather than using the same quantum for all 64 coefficients, JPEG uses a
quantization table that gives the quantum to use for each of the
coefficients, as specified in the formula given below. You can think of
this table (<code>Quantum</code>) as a parameter that can be set to control how
much information is lost and, correspondingly, how much compression is
achieved. In practice, the JPEG standard specifies a set of quantization
tables that have proven effective in compressing digital images; an
example quantization table is given in <a href="#quant">Table 1</a>. In tables
like this one, the low coefficients have a quantum close to 1 (meaning
that little low-frequency information is lost) and the high coefficients
have larger values (meaning that more high-frequency information is
lost). Notice that as a result of such quantization tables many of the
high-frequency coefficients end up being set to 0 after quantization,
making them ripe for further compression in the third phase.</p>
<p>The basic quantization equation is</p>
<pre><code class="lang-pseudo">QuantizedValue(i,j) = IntegerRound(DCT(i,j), Quantum(i,j))
</code></pre>
<p>where</p>
<pre><code class="lang-pseudo">IntegerRound(x) =
    Floor(x + 0.5) if x &gt;= 0
    Floor(x - 0.5) if x &lt; 0
</code></pre>
<p>Decompression is then simply defined as</p>
<pre><code class="lang-pseudo">DCT(i,j) = QuantizedValue(i,j) x Quantum(i,j)
</code></pre>
<p>For example, if the DC coefficient (i.e., DCT(0,0)) for a particular
block was equal to 25, then the quantization of this value using
<a href="#quant">Table 1</a> would result in</p>
<pre><code class="lang-pseudo">Floor(25/3+0.5) = 8
</code></pre>
<p>During decompression, this coefficient would then be restored as
8 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> 3 = 24.</p>
<h3 id="encoding-phase">Encoding Phase</h3>
<p>The final phase of JPEG encodes the quantized frequency coefficients in
a compact form. This results in additional compression, but this
compression is lossless. Starting with the DC coefficient in position
(0,0), the coefficients are processed in the zigzag sequence shown in
<a href="#zigzag">Figure 3</a>. Along this zigzag, a form of run length encoding
is used&#x2014;RLE is applied to only the 0 coefficients, which is
significant because many of the later coefficients are 0. The individual
coefficient values are then encoded using a Huffman code. (The JPEG
standard allows the implementer to use an arithmetic coding instead of
the Huffman code.)</p>
<figure class="line">
    <a id="zigzag"></a>
    <img src="figures/f07-13-9780123850591.png" width="300px">
    <figcaption>Zigzag traversal of quantized frequency coefficients.</figcaption>
</figure>

<p>In addition, because the DC coefficient contains a large percentage of
the information about the 8 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> 8 block from the source image, and
images typically change slowly from block to block, each DC coefficient
is encoded as the difference from the previous DC coefficient. This is
the delta encoding approach described in a later section.</p>
<p>JPEG includes a number of variations that control how much compression
you achieve versus the fidelity of the image. This can be done, for
example, by using different quantization tables. These variations, plus
the fact that different images have different characteristics, make it
impossible to say with any precision the compression ratios that can be
achieved with JPEG. Ratios of 30:1 are common, and higher ratios are
certainly possible, but <em>artifacts</em> (noticeable distortion due to
compression) become more severe at higher ratios.</p>
<h2 id="video-compression-mpeg">Video Compression (MPEG)</h2>
<p>We now turn our attention to the MPEG format, named after the Moving
Picture Experts Group that defined it. To a first approximation, a
moving picture (i.e., video) is simply a succession of still
images&#x2014;also called <em>frames</em> or <em>pictures</em>&#x2014;displayed at some video
rate. Each of these frames can be compressed using the same DCT-based
technique used in JPEG. Stopping at this point would be a mistake,
however, because it fails to remove the interframe redundancy present in
a video sequence. For example, two successive frames of video will
contain almost identical information if there is not much motion in the
scene, so it would be unnecessary to send the same information twice.
Even when there is motion, there may be plenty of redundancy since a
moving object may not change from one frame to the next; in some cases,
only its position changes. MPEG takes this interframe redundancy into
consideration. MPEG also defines a mechanism for encoding an audio
signal with the video, but we consider only the video aspect of MPEG in
this section.</p>
<h3 id="frame-types">Frame Types</h3>
<p>MPEG takes a sequence of video frames as input and compresses them into
three types of frames, called <em>I frames</em> (intrapicture), <em>P frames</em>
(predicted picture), and <em>B frames</em> (bidirectional predicted picture).
Each frame of input is compressed into one of these three frame types.
I frames can be thought of as reference frames; they are self-contained,
depending on neither earlier frames nor later frames. To a first
approximation, an I frame is simply the JPEG compressed version of the
corresponding frame in the video source. P and B frames are not
self-contained; they specify relative differences from some reference
frame. More specifically, a P frame specifies the differences from the
previous I frame, while a B frame gives an interpolation between the
previous and subsequent I or P frames.</p>
<figure class="line">
    <a id="mpeg"></a>
    <img src="figures/f07-14-9780123850591.png" width="500px">
    <figcaption>Sequence of I, P, and B frames generated by MPEG.</figcaption>
</figure>

<p><a href="#mpeg">Figure 4</a> illustrates a sequence of seven video frames that,
after being compressed by MPEG, result in a sequence of I, P, and B
frames. The two I frames stand alone; each can be decompressed at the
receiver independently of any other frames. The P frame depends on the
preceding I frame; it can be decompressed at the receiver only if the
preceding I frame also arrives. Each of the B frames depends on both the
preceding I or P frame and the subsequent I or P frame. Both of these
reference frames must arrive at the receiver before MPEG can decompress
the B frame to reproduce the original video frame.</p>
<p>Note that, because each B frame depends on a later frame in the
sequence, the compressed frames are not transmitted in sequential order.
Instead, the sequence I B B P B B I shown in <a href="#mpeg">Figure 4</a> is
transmitted as I P B B I B B. Also, MPEG does not define the ratio of
I frames to P and B frames; this ratio may vary depending on the
required compression and picture quality. For example, it is permissible
to transmit only I frames. This would be similar to using JPEG to
compress the video.</p>
<p>In contrast to the preceding discussion of JPEG, the following focuses
on the <em>decoding</em> of an MPEG stream. It is a little easier to describe,
and it is the operation that is more often implemented in networking
systems today, since MPEG coding is so expensive that it is frequently
done offline (i.e., not in real time). For example, in a video-on-demand
system, the video would be encoded and stored on disk ahead of time.
When a viewer wanted to watch the video, the MPEG stream would then be
transmitted to the viewer&apos;s machine, which would decode and display the
stream in real time.</p>
<p>Let&apos;s look more closely at the three frame types. As mentioned above,
I frames are approximately equal to the JPEG compressed version of the
source frame. The main difference is that MPEG works in units of
16 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> 16 macroblocks. For a color video represented in YUV, the
U and V components in each macroblock are subsampled into
an 8 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> 8 block, as we discussed above in the context of JPEG.
Each 2 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> 2
subblock in the macroblock is given by one U value and one V value&#x2014;the
average of the four pixel values. The subblock still has four Y values.
The relationship between a frame and the corresponding macroblocks is
given in <a href="#macroblock">Figure 5</a>.</p>
<figure class="line">
    <a id="macroblock"></a>
    <img src="figures/f07-15-9780123850591.png" width="500px">
    <figcaption>Each frame as a collection of macroblocks.</figcaption>
</figure>

<p>The P and B frames are also processed in units of macroblocks.
Intuitively, we can see that the information they carry for each
macroblock captures the motion in the video; that is, it shows in what
direction and how far the macroblock moved relative to the reference
frame(s). The following describes how a B frame is used to reconstruct a
frame during decompression; P frames are handled in a similar manner,
except that they depend on only one reference frame instead of two.</p>
<p>Before getting to the details of how a B frame is decompressed, we first
note that each macroblock in a B frame is not necessarily defined
relative to both an earlier and a later frame, as suggested above, but
may instead simply be specified relative to just one or the other. In
fact, a given macroblock in a B frame can use the same intracoding as is
used in an I frame. This flexibility exists because if the motion
picture is changing too rapidly then it sometimes makes sense to give
the intrapicture encoding rather than a forward- or backward-predicted
encoding. Thus, each macroblock in a B frame includes a type field that
indicates which encoding is used for that macroblock. In the following
discussion, however, we consider only the general case in which the
macroblock uses bidirectional predictive encoding.</p>
<p>In such a case, each macroblock in a B frame is represented with a
4-tuple: (1) a coordinate for the macroblock in the frame, (2) a motion
vector relative to the previous reference frame, (3) a motion vector
relative to the subsequent reference frame, and (4) a delta (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi></mrow><annotation encoding="application/x-tex">\delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span></span></span></span>)
for each pixel in the macroblock (i.e., how much each pixel has changed
relative to the two reference pixels). For each pixel in the macroblock,
the first task is to find the corresponding reference pixel in the past
and future reference frames. This is done using the two motion vectors
associated with the macroblock. Then, the delta for the pixel is added
to the average of these two reference pixels. Stated more precisely, if
we let <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">F_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">F_f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> denote the past and future reference frames,
respectively, and the past/future motion vectors are given by
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>x</mi><mi>p</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>p</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(x_p,y_p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>x</mi><mi>f</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>f</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(x_f,y_f)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span>, then the pixel at coordinate
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> in the current frame (denoted <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">F_c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">c</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>) is computed as</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mi>c</mi></msub><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo><mo>=</mo><mo>(</mo><msub><mi>F</mi><mi>p</mi></msub><mo>(</mo><mi>x</mi><mo>+</mo><msub><mi>x</mi><mi>p</mi></msub><mo separator="true">,</mo><mi>y</mi><mo>+</mo><msub><mi>y</mi><mi>p</mi></msub><mo>)</mo><mo>+</mo><msub><mi>F</mi><mi>f</mi></msub><mo>(</mo><mi>x</mi><mo>+</mo><msub><mi>x</mi><mi>f</mi></msub><mo separator="true">,</mo><mi>y</mi><mo>+</mo><msub><mi>y</mi><mi>f</mi></msub><mo>)</mo><mo>)</mo><mi mathvariant="normal">/</mi><mn>2</mn><mo>+</mo><mi>&#x3B4;</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">
F_c(x,y) = (F_p(x+x_p,y+y_p) + F_f(x+x_f,y+y_f))/2 + \delta(x,y)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">c</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mord mathrm">/</span><span class="mord mathrm">2</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi></mrow><annotation encoding="application/x-tex">\delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span></span></span></span> is the delta for the pixel as specified in the B frame.
These deltas are encoded in the same way as pixels in I frames; that is,
they are run through DCT and then quantized. Since the deltas are
typically small, most of the DCT coefficients are 0 after quantization;
hence, they can be effectively compressed.</p>
<p>It should be fairly clear from the preceding discussion how encoding
would be performed, with one exception. When generating a B or P frame
during compression, MPEG must decide where to place the macroblocks.
Recall that each macroblock in a P frame, for example, is defined
relative to a macroblock in an I frame, but that the macroblock in the
P frame need not be in the same part of the frame as the corresponding
macroblock in the I frame&#x2014;the difference in position is given by the
motion vector. You would like to pick a motion vector that makes the
macroblock in the P frame as similar as possible to the corresponding
macroblock in the I frame, so that the deltas for that macroblock can be
as small as possible. This means that you need to figure out where
objects in the picture moved from one frame to the next. This is the
problem of <em>motion estimation</em>, and several techniques (heuristics) for
solving this problem are known. (We discuss papers that consider this
problem at the end of this chapter.) The difficulty of this problem is
one of the reasons why MPEG encoding takes longer than decoding on
equivalent hardware. MPEG does not specify any particular technique; it
only defines the format for encoding this information in B and P frames
and the algorithm for reconstructing the pixel during decompression, as
given above.</p>
<h3 id="effectiveness-and-performance">Effectiveness and Performance</h3>
<p>MPEG typically achieves a compression ratio of 90:1, although ratios as
high as 150:1 are not unheard of. In terms of the individual frame
types, we can expect a compression ratio of approximately 30:1 for the
I frames (this is consistent with the ratios achieved using JPEG when
24-bit color is first reduced to 8-bit color), while P and B frame
compression ratios are typically three to five times smaller than the
rates for the I frame. Without first reducing the 24 bits of color to
8 bits, the achievable compression with MPEG is typically between 30:1
and 50:1.</p>
<p>MPEG involves an expensive computation. On the compression side, it is
typically done offline, which is not a problem for preparing movies for
a video-on-demand service. Video can be compressed in real time using
hardware today, but software implementations are quickly closing the
gap. On the decompression side, low-cost MPEG video boards are
available, but they do little more than YUV color lookup, which
fortunately is the most expensive step. Most of the actual MPEG decoding
is done in software. In recent years, processors have become fast enough
to keep pace with 30-frames-per-second video rates when decoding MPEG
streams purely in software&#x2014;modern processors can even decode MPEG
streams of high definition video (HDTV).</p>
<h3 id="video-encoding-standards">Video Encoding Standards</h3>
<p>We conclude by noting that MPEG is an evolving standard of significant
complexity. This complexity comes from a desire to give the encoding
algorithm every possible degree of freedom in how it encodes a given
video stream, resulting in different video transmission rates. It also
comes from the evolution of the standard over time, with the Moving
Picture Experts Group working hard to retain backwards compatibility
(e.g., MPEG-1, MPEG-2, MPEG-4). What we describe in this book is the
essential ideas underlying MPEG-based compression, but certainly not
all the intricacies involved in an international standard.</p>
<p>What&apos;s more, MPEG is not the only standard available for encoding
video. For example, the ITU-T has also defined the <em>H series</em>
for encoding real-time multimedia data. Generally, the H series
includes standards for video, audio, control, and multiplexing (e.g.,
mixing audio, video, and data onto a single bit stream). Within the
series, H.261 and H.263 were the first- and second-generation video
encoding standards. In principle, both H.261 and H.263 look a lot 
like MPEG: They use DCT, quantization, and interframe compression. The 
differences between H.261/H.263 and MPEG are in the details.</p>
<p>Today, a partnership between the ITU-T and the MPEG group has lead to
the joint H.264/MPEG-4 standard, which is used for both Blu-ray Discs
and by many popular streaming sources (e.g., YouTube, Vimeo).</p>
<h2 id="transmitting-mpeg-over-a-network">Transmitting MPEG over a Network</h2>
<p>As we&apos;ve noted, MPEG and JPEG are not just compression standards but
also definitions of the format of video and images, respectively.
Focusing on MPEG, the first thing to keep in mind is that it defines the
format of a video <em>stream</em>; it does not specify how this stream is
broken into network packets. Thus, MPEG can be used for videos stored on
disk, as well as videos transmitted over a stream-oriented network
connection, like that provided by TCP.</p>
<p>What we describe below is called the <em>main profile</em> of an MPEG video
stream that is being sent over a network. You can think of an MPEG
profile as being analogous to a &quot;version,&quot; except the profile is not
explicitly specified in an MPEG header; the receiver has to deduce the
profile from the combination of header fields it sees.</p>
<figure class="line">
    <a id="nested"></a>
    <img src="figures/f07-16-9780123850591.png" width="500px">
    <figcaption>Format of an MPEG-compressed video stream.</figcaption>
</figure>

<p>A main profile MPEG stream has a nested structure, as illustrated in
<a href="#nested">Figure 6</a>. (Keep in mind that this figure hides a <em>lot</em> of
messy details.) At the outermost level, the video contains a sequence of
groups of pictures (GOP) separated by a <code>SeqHdr</code>. The sequence is
terminated by a <code>SeqEndCode</code> (<code>0xb7</code>). The <code>SeqHdr</code> that precedes
every GOP specifies&#x2014;among other things&#x2014;the size of each picture
(frame) in the GOP (measured in both pixels and macroblocks), the
interpicture period (measured in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BC;</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BC;</span></span></span></span>s), and two quantization matrices
for the macroblocks within this GOP: one for intracoded macroblocks
(I blocks) and one for intercoded macroblocks (B and P blocks). Since
this information is given for each GOP&#x2014;rather than once for the entire
video stream, as you might expect&#x2014;it is possible to change the
quantization table and frame rate at GOP boundaries throughout the
video. This makes it possible to adapt the video stream over time, as we
discuss below.</p>
<p>Each GOP is given by a <code>GOPHdr</code>, followed by the set of pictures that
make up the GOP. The <code>GOPHdr</code> specifies the number of pictures in the
GOP, as well as synchronization information for the GOP (i.e., when the
GOP should play, relative to the beginning of the video). Each picture,
in turn, is given by a <code>PictureHdr</code> and a set of <em>slices</em> that make up
the picture. (A slice is a region of the picture, such as one horizontal
line.) The <code>PictureHdr</code> identifies the type of the picture (I, B, or
P) and defines a picture-specific quantization table. The <code>SliceHdr</code>
gives the vertical position of the slice, plus another opportunity to
change the quantization table&#x2014;this time by a constant scaling factor
rather than by giving a whole new table. Next, the <code>SliceHdr</code> is
followed by a sequence of macroblocks. Finally, each macroblock includes
a header that specifies the block address within the picture, along with
data for the six blocks within the macroblock: one for the U component,
one for the V component, and four for the Y component. (Recall that the
Y component is 16 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> 16, while the U and V components are
8 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> 8.)</p>
<p>It should be clear that one of the powers of the MPEG format is that it
gives the encoder an opportunity to change the encoding over time. It
can change the frame rate, the resolution, the mix of frame types that
define a GOP, the quantization table, and the encoding used for
individual macroblocks. As a consequence, it is possible to adapt the
rate at which a video is transmitted over a network by trading picture
quality for network bandwidth. Exactly how a network protocol might
exploit this adaptability is currently a subject of research (see
sidebar).</p>
<p>Another interesting aspect of sending an MPEG stream over the network is
exactly how the stream is broken into packets. If sent over a TCP
connection, packetization is not an issue; TCP decides when it has
enough bytes to send the next IP datagram. When using video
interactively, however, it is rare to transmit it over TCP, since TCP
has several features that are ill suited to highly latency-sensitive
applications (such as abrupt rate changes after a packet loss and
retransmission of lost packets). If we are transmitting video using UDP,
say, then it makes sense to break the stream at carefully selected
points, such as at macroblock boundaries. This is because we would like
to confine the effects of a lost packet to a single macroblock, rather
than damaging several macroblocks with a single loss. This is an example
of Application Level Framing, which was discussed in an earlier chapter.</p>
<p>Packetizing the stream is only the first problem in sending
MPEG-compressed video over a network. The next complication is dealing
with packet loss. On the one hand, if a B frame is dropped by the
network, then it is possible to simply replay the previous frame without
seriously compromising the video; 1 frame out of 30 is no big deal. On
the other hand, a lost I frame has serious consequences&#x2014;none of the
subsequent B and P frames can be processed without it. Thus, losing an
I frame would result in losing multiple frames of the video. While you
could retransmit the missing I frame, the resulting delay would probably
not be acceptable in a real-time videoconference. One solution to this
problem would be to use the Differentiated Services techniques described
in the previous chapter to mark the packets containing I frames with a
lower drop probability than other packets.</p>
<p>One final observation is that how you choose to encode video depends on
more than just the available network bandwidth. It also depends on the
application&apos;s latency constraints. Once again, an interactive
application like videoconferencing needs small latencies. The critical
factor is the combination of I, P, and B frames in the GOP. Consider the
following GOP:</p>
<div class="ba-center"><p>I B B B B P B B B B I</p></div>

<p>The problem this GOP causes a videoconferencing application is that the
sender has to delay the transmission of the four B frames until the P or
I that follows them is available. This is because each B frame depends
on the subsequent P or I frame. If the video is playing at 15 frames per
second (i.e., one frame every 67 ms), this means the first B frame is
delayed 4 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> 67 ms, which is more than a quarter of a second.
This delay is in addition to any propagation delay imposed by the
network. A quarter of a second is far greater than the 100-ms
threshold that humans are able to perceive. It is for this reason that
many videoconference applications encode video using JPEG, which is
often called motion-JPEG. (Motion-JPEG also addresses the problem of
dropping a reference frame since all frames are able to stand alone.)
Notice, however, that an interframe encoding that depends upon only
prior frames rather than later frames is not a problem. Thus, a GOP of</p>
<div class="ba-center"><p>I P P P P I</p></div>

<p>would work just fine for interactive videoconferencing.</p>
<h3 id="adaptive-streaming">Adaptive Streaming</h3>
<p>Because encoding schemes like MPEG allow for a trade-off between the
bandwidth consumed and the quality of the image, there is an
opportunity to adapt a video stream to match the available network
bandwidth. This is effectively what video streaming services like
Netflix do today.</p>
<p>For starters, let&apos;s assume that we have some way to measure the amount
of free capacity and level of congestion along a path, for example, by
observing the rate at which packets are successfully arriving at the
destination. As the available bandwidth fluctuates, we can feed that
information back to the codec so that it adjusts its coding parameters
to back off during congestion and to send more aggressively (with a
higher picture quality) when the network is idle. This is analogous to
the behavior of TCP, except in the video case we are actually
modifying the total amount of data sent rather than how long we take
to send a fixed amount of data, since we don&apos;t want to introduce delay
into a video application.</p>
<p>In the case of video-on-demand services like Netflix, we don&apos;t adapt
the encoding on the fly, but instead we encode a handful of video
quality levels ahead of time, and save them to files named accordingly.
The receiver simply changes the file name it requests to match the
quality its measurements indicate the network will be able to deliver.
The receiver watches its playback queue, and asks for a higher
quality encoding when the queue becomes too full and a lower quality
encoding when the queue becomes too empty.</p>
<p>How does this approach know where in the movie to jump to should
the requested quality change? In effect, the receiver never asks the
sender to stream the whole movie, but instead it requests a sequence
of short movie segments, typically a few seconds long (and always on
GOP boundary). Each segment is an opportunity to change the quality
level to match what the network is able to deliver. (It turns out that
requesting movie chunks also makes it easier to implement <em>trick
play</em>, jumping around from one place to another in the movie.) In
other words, a movie is typically stored as a set of N <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> M
chunks (files): N quality levels for each of M segments.</p>
<p>There&apos;s one last detail. Since the receiver is effectively requesting a
sequence of discrete video chunks by name, the most common approach
for issuing these requests is to use HTTP. Each chuck is a separate HTTP
GET request with the URL identifying the specific chunk the receiver
wants next. When you start downloading a movie, your video player first
downloads a <em>manifest</em> file that contains nothing more than the URLs
for the N <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#xD7;</span></span></span></span> M chunks in the movie, and then it issues a
sequence of HTTP requests using the appropriate URL for the
situation. This general approach is called <em>HTTP adaptive streaming</em>,
although it has been standardized in slightly different ways by various
organizations, most notably MPEG&apos;s DASH (<em>Dynamic Adaptive Streaming
over HTTP</em>) and Apple&apos;s HLS (<em>HTTP Live Streaming</em>).</p>
<h2 id="audio-compression-mp3">Audio Compression (MP3)</h2>
<p>Not only does MPEG define how video is compressed, but it also defines a
standard for compressing audio. This standard can be used to compress
the audio portion of a movie (in which case the MPEG standard defines
how the compressed audio is interleaved with the compressed video in a
single MPEG stream) or it can be used to compress stand-alone audio (for
example, an audio CD).</p>
<p>To understand audio compression, we need to begin with the data.
CD-quality audio, which is the <em>de facto</em> digital representation for
high-quality audio, is sampled at a rate of 44.1 KHz (i.e., a sample is
collected approximately once every 23 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BC;</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BC;</span></span></span></span>s). Each sample is 16 bits,
which means that a stereo (2-channel) audio stream results in a bit
rate of</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mo>&#xD7;</mo><mn>4</mn><mn>4</mn><mi mathvariant="normal">.</mi><mn>1</mn><mo>&#xD7;</mo><mn>1</mn><mn>0</mn><mn>0</mn><mn>0</mn><mo>&#xD7;</mo><mn>1</mn><mn>6</mn><mo>=</mo><mn>1</mn><mi mathvariant="normal">.</mi><mn>4</mn><mn>1</mn><mtext>&#xA0;</mtext><mi>M</mi><mi>b</mi><mi>p</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">
2 \times 44.1 \times 1000 \times 16 = 1.41\ Mbps
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathrm">2</span><span class="mbin">&#xD7;</span><span class="mord mathrm">4</span><span class="mord mathrm">4</span><span class="mord mathrm">.</span><span class="mord mathrm">1</span><span class="mbin">&#xD7;</span><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mbin">&#xD7;</span><span class="mord mathrm">1</span><span class="mord mathrm">6</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">.</span><span class="mord mathrm">4</span><span class="mord mathrm">1</span><span class="mord mathit"><span class="mspace">&#xA0;</span><span class="mord mathit" style="margin-right:0.10903em;">M</span></span><span class="mord mathit">b</span><span class="mord mathit">p</span><span class="mord mathit">s</span></span></span></span></span></p>
<p>By comparison, telephone-quality voice is sampled at a rate of 8 KHz,
with 8-bit samples, resulting in a bit rate of 64 kbps.</p>
<p>Clearly, some amount of compression is going to be required to transmit
CD-quality audio over, say, the 128-kbps capacity of an ISDN data/voice
line pair. To make matters worse, synchronization and error correction
overhead require that 49 bits be used to encode each 16-bit sample,
resulting in an actual bit rate of</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn><mn>9</mn><mi mathvariant="normal">/</mi><mn>1</mn><mn>6</mn><mo>&#xD7;</mo><mn>1</mn><mi mathvariant="normal">.</mi><mn>4</mn><mn>1</mn><mtext>&#xA0;</mtext><mi>M</mi><mi>b</mi><mi>p</mi><mi>s</mi><mo>=</mo><mn>4</mn><mi mathvariant="normal">.</mi><mn>3</mn><mn>2</mn><mtext>&#xA0;</mtext><mi>M</mi><mi>b</mi><mi>p</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">
49/16 \times 1.41\ Mbps = 4.32\ Mbps
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathrm">4</span><span class="mord mathrm">9</span><span class="mord mathrm">/</span><span class="mord mathrm">1</span><span class="mord mathrm">6</span><span class="mbin">&#xD7;</span><span class="mord mathrm">1</span><span class="mord mathrm">.</span><span class="mord mathrm">4</span><span class="mord mathrm">1</span><span class="mord mathit"><span class="mspace">&#xA0;</span><span class="mord mathit" style="margin-right:0.10903em;">M</span></span><span class="mord mathit">b</span><span class="mord mathit">p</span><span class="mord mathit">s</span><span class="mrel">=</span><span class="mord mathrm">4</span><span class="mord mathrm">.</span><span class="mord mathrm">3</span><span class="mord mathrm">2</span><span class="mord mathit"><span class="mspace">&#xA0;</span><span class="mord mathit" style="margin-right:0.10903em;">M</span></span><span class="mord mathit">b</span><span class="mord mathit">p</span><span class="mord mathit">s</span></span></span></span></span></p>
<p>MPEG addresses this need by defining three levels of compression, as
enumerated in <a href="#mp3">Table 2</a>. Of these, Layer III, which is more
widely known as MP3, is the most commonly used.</p>
<p><a id="mp3"></a></p>
<table>
<thead>
<tr>
<th style="text-align:center">Coding</th>
<th style="text-align:center">Bit Rates</th>
<th style="text-align:center">Compression Factor</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Layer I</td>
<td style="text-align:center">384 kbps</td>
<td style="text-align:center">14</td>
</tr>
<tr>
<td style="text-align:center">Layer II</td>
<td style="text-align:center">192 kbps</td>
<td style="text-align:center">18</td>
</tr>
<tr>
<td style="text-align:center">Layer III</td>
<td style="text-align:center">128 kbps</td>
<td style="text-align:center">12</td>
</tr>
</tbody>
</table>
<div class="ba-center"><p><em>Table 2. MP3 Compression Rates.</em></p></div>

<p>To achieve these compression ratios, MP3 uses techniques that are
similar to those used by MPEG to compress video. First, it splits the
audio stream into some number of frequency subbands, loosely analogous
to the way MPEG processes the Y, U, and V components of a video stream
separately. Second, each subband is broken into a sequence of blocks,
which are similar to MPEG&apos;s macroblocks except they can vary in length
from 64 to 1024 samples. (The encoding algorithm can vary the block size
depending on certain distortion effects that are beyond our discussion.)
Finally, each block is transformed using a modified DCT algorithm,
quantized, and Huffman encoded, just as for MPEG video.</p>
<p>The trick to MP3 is how many subbands it elects to use and how many bits
it allocates to each subband, keeping in mind that it is trying to
produce the highest-quality audio possible for the target bit rate.
Exactly how this allocation is made is governed by psychoacoustic models
that are beyond the scope of this book, but to illustrate the idea
consider that it makes sense to allocate more bits to low-frequency
subbands when compressing a male voice and more bits to high-frequency
subbands when compressing a female voice. Operationally, MP3 dynamically
changes the quantization tables used for each subband to achieve the
desired effect.</p>
<p>Once compressed, the subbands are packaged into fixed-size frames, and a
header is attached. This header includes synchronization information, as
well as the bit allocation information needed by the decoder to
determine how many bits are used to encode each subband. As mentioned
above, these audio frames can then be interleaved with video frames to
form a complete MPEG stream. One interesting side note is that, while it
might work to drop B frames in the network should congestion occur,
experience teaches us that it is not a good idea to drop audio frames
since users are better able to tolerate bad video than bad audio.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="presentation.html" class="navigation navigation-prev " aria-label="Previous page: 7.1 Presentation Formatting">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="summary.html" class="navigation navigation-next " aria-label="Next page: 7.3 Summary">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"7.2 Multimedia Data","level":"1.8.2","depth":2,"next":{"title":"7.3 Summary","level":"1.8.3","depth":2,"path":"data/summary.md","ref":"data/summary.md","articles":[]},"previous":{"title":"7.1 Presentation Formatting","level":"1.8.1","depth":2,"path":"data/presentation.md","ref":"data/presentation.md","articles":[]},"dir":"ltr"},"config":{"plugins":["anchorjs","katex","block-align","sequence-diagrams","creativecommons","custom-favicon","smart-nav-collapse"],"root":".","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css"},"pluginsConfig":{"block-align":{},"search":{},"sequence-diagrams":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"favicon":"bridge.ico","custom-favicon":{},"creativecommons":{},"smart-nav-collapse":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchorjs":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"branch":"master"},"title":"Computer Networks: A Systems Approach","gitbook":"*"},"file":{"path":"data/multimedia.md","mtime":"2019-03-01T22:41:42.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-03-14T18:19:15.443Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-anchorjs/anchor.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-anchorjs/anchor-style.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-smart-nav-collapse/smart-nav-collapse.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

